<!doctype html>
<html lang="en" x-data="app()" :class="{'overflow-hidden': sidebarOpen}">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ignite LMS</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Alpine.js -->
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            rust: {
              50:'#fdf4f2',100:'#fde8e4',200:'#f8d3cc',300:'#efb7ad',400:'#e19080',
              500:'#cf6f5b',600:'#b35146',700:'#8f3c35',800:'#73332f',900:'#5f2d2b'
            },
            sand: {
              50:'#faf7f3',100:'#f4efe9',200:'#ebe2d8',300:'#dfd1c1',400:'#cbb7a1',
              500:'#b7a089',600:'#9a836c',700:'#7c6957',800:'#645448',900:'#52463c'
            }
          },
          boxShadow: {
            card: '0 1px 2px rgba(15,23,42,.05), 0 12px 24px -8px rgba(15,23,42,.10)'
          },
          borderRadius: {
            xl2: '1.25rem'
          }
        }
      }
    }
  </script>
  <style>[x-cloak]{display:none!important}</style>
</head>
<body class="bg-sand-50 text-slate-800 selection:bg-rust-200/60">

  <div class="min-h-dvh flex">

    <!-- Sidebar -->
    <aside
      class="w-64 bg-white border-r border-sand-200/70 fixed inset-y-0 left-0 z-30 md:static md:translate-x-0 transform transition-transform duration-200"
      :class="sidebarOpen ? 'translate-x-0' : '-translate-x-full md:translate-x-0'">

      <!-- Brand -->
      <div class="px-5 pt-6 pb-4 flex items-center gap-3 border-b border-sand-200/70">
        <div class="h-10 w-10 rounded-full bg-rust-500/90 flex items-center justify-center shadow-card">
          <span class="text-white font-semibold">I</span>
        </div>
        <div>
          <div class="text-slate-900 font-semibold">Ignite</div>
          <div class="text-xs text-slate-500">Fall 2025</div>
        </div>
      </div>

      <!-- Nav (icons + labels) -->
      <nav class="p-2 space-y-1 text-sm flex-1 overflow-y-auto">
        <template x-for="item in [
          {k:'dashboard',label:'Dashboard',  icon:'M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l-2 2m-2-2v10a1 1 0 01-1 1h-3m-3 0V9a1 1 0 011-1h6a1 1 0 011 1v10a1 1 0 01-1 1h-3'},
          {k:'courses',  label:'Courses',    icon:'M4 6h16M4 12h16m-7 6h7'},
          {k:'assignments',label:'Assignments', icon:'M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z'},
          {k:'quizzes',  label:'Quizzes & Tests', icon:'M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m0 0l-3 3m7-3v4a2 2 0 002 2h2'},
          {k:'grades',   label:'Grades',     icon:'M3 6l7-7 7 7M10 3v18'},
          {k:'ai',       label:'AI Assistant', icon:'M9.333 9.75a2.5 2.5 0 005.334 0 2.5 2.5 0 00-5.334 0zM12 21a9 9 0 110-18 9 9 0 010 18z'}
        ]" :key="item.k">
          <button
            class="w-full text-left px-3 py-2 rounded flex items-center gap-3 hover:bg-sand-100"
            :class="page===item.k && 'bg-sand-100 text-slate-900 font-semibold'"
            @click="page=item.k">
            <svg class="h-5 w-5 text-slate-700" xmlns="http://www.w3.org/2000/svg" fill="none"
                viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" :d="item.icon"/>
            </svg>
            <span x-text="item.label"></span>
          </button>
        </template>
      </nav>

      <!-- Bottom: Profile & Settings + user chip -->
      <div class="p-2 border-t border-sand-200/70">
        <button class="w-full text-left px-3 py-2 rounded flex items-center gap-3 hover:bg-sand-100"
                :class="page==='profile' && 'bg-sand-100 text-slate-900 font-semibold'"
                @click="page='profile'">
          <svg class="h-5 w-5 text-slate-700" xmlns="http://www.w3.org/2000/svg" fill="none"
              viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round"
                  d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
          </svg>
          Profile
        </button>
        <button class="w-full text-left px-3 py-2 rounded flex items-center gap-3 hover:bg-sand-100"
                :class="page==='settings' && 'bg-sand-100 text-slate-900 font-semibold'"
                @click="page='settings'">
          <svg class="h-5 w-5 text-slate-700" xmlns="http://www.w3.org/2000/svg" fill="none"
              viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round"
                  d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.608 3.3 0z" />
            <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
          </svg>
          Settings
        </button>

        <div class="mt-3 px-3 pb-3">
          <div class="flex items-center gap-3">
            <div class="h-9 w-9 rounded-full bg-sand-200 grid place-items-center text-slate-600 font-semibold">
              <span x-text="(profile.firstName||'A').slice(0,1)"></span>
            </div>
            <div class="min-w-0">
              <div class="font-medium truncate" x-text="profile.firstName || 'Student'"></div>
              <div class="text-slate-500 text-xs truncate" x-text="profile.email || 'student@university.edu'"></div>
            </div>
          </div>
        </div>
      </div>
    </aside>


    <!-- Main -->
    <main class="flex-1 md:ml-0 ml-0 md:relative md:left-0 left-0">
      <!-- Mobile top bar -->
      <div class="md:hidden sticky top-0 z-20 bg-white/80 backdrop-blur border-b border-sand-200/70">
        <div class="px-4 py-3 flex items-center justify-between">
          <div class="flex items-center gap-3">
            <button @click="sidebarOpen=!sidebarOpen" class="p-2 rounded-lg hover:bg-sand-100">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
            </button>
            <div class="font-semibold">Ignite</div>
          </div>
          <div class="text-xs text-slate-500">Fall 2025</div>
        </div>
      </div>

      <div class="max-w-[1200px] mx-auto px-5 sm:px-8 py-8">

        <!-- DASHBOARD (restored with calendar) -->
        <!-- DASHBOARD -->
        <section x-show="page==='dashboard'" x-cloak
          x-data="{
            // --- Left list (matches your screenshot content) ---
            newsItems: [
              { id: 1, title: 'New Computer Science Lab Opens on Campus', kind: 'NEWS', date: 'Oct 20, 2025',
                desc: 'Cutting-edge workspace for students and researchers.',
                img: 'https://images.unsplash.com/photo-1518770660439-4636190af475?q=80&w=800&auto=format&fit=crop' },
              { id: 2, title: 'Spring 2026 Registration Now Open', kind: 'EVENT', date: 'Oct 18, 2025',
                desc: 'Priority registration ends Nov 1. Check your time slot now!',
                img: 'https://images.unsplash.com/photo-1503676382389-4809596d5290?q=80&w=800&auto=format&fit=crop' },
              { id: 3, title: 'Guest Lecture: The Future of AI in Education', kind: 'NEWS', date: 'Oct 15, 2025',
                desc: 'Prof. Anya Sharma from Tech University to speak on Oct 25.',
                img: 'https://images.unsplash.com/photo-1517841905240-472988babdf9?q=80&w=800&auto=format&fit=crop' },
              { id: 4, title: 'Career Fair 2025: Meet Top Employers', kind: 'EVENT', date: 'Oct 12, 2025',
                desc: 'Explore internship and job opportunities. RSVP by Oct 30.',
                img: 'https://images.unsplash.com/photo-1450101499163-c8848c66ca85?q=80&w=800&auto=format&fit=crop' },
              { id: 5, title: 'New Online Course on Data Science Fundamentals', kind: 'NEWS', date: 'Oct 10, 2025',
                desc: 'Enroll now for an exciting journey into data analytics!',
                img: 'https://images.unsplash.com/photo-1519389950473-47ba0277781c?q=80&w=800&auto=format&fit=crop' },
            ],

            // --- Calendar state (October 2025 like your screenshot) ---
            months:['January','February','March','April','May','June','July','August','September','October','November','December'],
            cal:{ year:2025, month:9, picked:15,
              days(){ const d=new Date(this.year,this.month+1,0).getDate(); return [...Array(d)].map((_,i)=>i+1) },
              prev(){ this.month===0?(this.month=11,this.year--):this.month-- },
              next(){ this.month===11?(this.month=0,this.year++):this.month++ }
            },

            // --- Deadlines to dot-mark and list (edit freely) ---
            deadlines:[
              { id:'a1', day:15, type:'Assignment', course:'Advanced Web Development', title:'WebDev Project Proposal Due', time:'11:59 PM', color:'bg-rose-50 text-rose-700 border-rose-200' },
              { id:'q1', day:30, type:'Quiz', course:'Data Structures & Algorithms', title:'Data Structures Chapter 3 Quiz', time:'2:00 PM', color:'bg-sky-50 text-sky-700 border-sky-200' },
              { id:'m1', day:21, type:'Milestone', course:'Linear Algebra', title:'Matrix Project Milestone', time:'5:00 PM', color:'bg-amber-50 text-amber-800 border-amber-200' },
              { id:'r1', day:28, type:'Reminder', course:'Career Center', title:'Resume Review Session', time:'3:00 PM', color:'bg-violet-50 text-violet-700 border-violet-200' },
              { id:'w1', day:9, type:'Workshop', course:'Library', title:'Citation Manager Workshop', time:'10:00 AM', color:'bg-emerald-50 text-emerald-700 border-emerald-200' },
            ],
            hasDeadline(d){ return this.deadlines.some(x => x.day===d && this.cal.month===9 && this.cal.year===2025) },
            todayDeadlines(){ return this.deadlines.filter(x => x.day===this.cal.picked && this.cal.month===9 && this.cal.year===2025) }
          }"
          class="space-y-6">

          <!-- Welcome strip (keeps your theme) -->
          <div class="rounded-2xl bg-rust-500/90 text-white px-6 py-5 shadow-card">
            <div class="flex items-center gap-3">
              <div class="h-10 w-10 rounded-full bg-white/20 grid place-items-center">
                <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6l4 2"/></svg>
              </div>
              <div class="text-xl font-semibold">Welcome back! <span aria-hidden>üëã</span></div>
            </div>
            <div class="mt-2 text-sm text-white/90">Believe in yourself and your abilities! ‚ú®</div>
          </div>

          <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Left: Latest News & Events -->
            <div class="lg:col-span-2 rounded-2xl bg-white shadow-card border border-sand-200/70">
              <div class="px-6 pt-5 pb-4">
                <div class="flex items-center gap-2 text-rust-600">
                  <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3"/></svg>
                  <h2 class="text-lg font-semibold text-slate-900">Latest News & Events</h2>
                </div>
              </div>

              <div class="px-4 pb-5 space-y-3">
                <template x-for="item in newsItems" :key="item.id">
                  <div class="rounded-xl border border-sand-200/70 bg-white px-3 py-3">
                    <div class="flex gap-3">
                      <img :src="item.img" class="h-16 w-20 rounded-md object-cover" alt="">
                      <div class="flex-1">
                        <div class="font-medium text-slate-900" x-text="item.title"></div>
                        <div class="mt-1 text-xs font-semibold"
                            :class="item.kind==='NEWS' ? 'text-amber-600' : 'text-emerald-600'"
                            x-text="item.kind"></div>
                        <div class="mt-1 text-xs text-slate-500" x-text="item.date"></div>
                        <p class="mt-1 text-sm text-slate-700" x-text="item.desc"></p>
                      </div>
                    </div>
                  </div>
                </template>
              </div>
            </div>

            <!-- Right: Important Dates + Calendar + Upcoming list -->
            <div class="rounded-2xl bg-white shadow-card border border-sand-200/70">
              <div class="px-6 pt-5">
                <div class="flex items-center gap-2 text-rust-600">
                  <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3M3 11h18M5 19h14"/></svg>
                  <h2 class="text-lg font-semibold text-slate-900">Important Dates</h2>
                </div>
              </div>

              <!-- Month header -->
              <div class="px-6 pt-3">
                <div class="flex items-center justify-between rounded-xl bg-sand-100 px-3 py-2">
                  <button class="p-1 hover:bg-white rounded-md" @click="cal.prev()">
                    <svg class="h-5 w-5 text-slate-700" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
                  </button>
                  <div class="text-sm font-medium text-slate-900" x-text="months[cal.month] + ' ' + cal.year"></div>
                  <button class="p-1 hover:bg-white rounded-md" @click="cal.next()">
                    <svg class="h-5 w-5 text-slate-700" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
                  </button>
                </div>
              </div>

              <!-- Calendar -->
              <div class="px-6 pb-3">
                <div class="mt-3 grid grid-cols-7 text-center text-xs text-slate-500">
                  <div>Su</div><div>Mo</div><div>Tu</div><div>We</div><div>Th</div><div>Fr</div><div>Sa</div>
                </div>
                <div class="mt-1 grid grid-cols-7 gap-1">
                  <template x-for="d in cal.days()" :key="d">
                    <button @click="cal.picked=d"
                      class="relative aspect-square rounded-md text-sm hover:bg-sand-100"
                      :class="cal.picked===d ? 'bg-amber-100 font-semibold text-slate-900' : 'text-slate-700'">
                      <span x-text="d"></span>
                      <!-- red dot for deadlines -->
                      <span x-show="hasDeadline(d)" class="absolute left-1/2 -translate-x-1/2 bottom-1 block h-1.5 w-1.5 rounded-full bg-rose-500"></span>
                    </button>
                  </template>
                </div>
              </div>

              <!-- Upcoming Deadlines for picked day -->
              <div class="px-6 pb-6">
                <div class="text-sm font-semibold text-slate-900">Upcoming Deadlines</div>
                <div class="mt-1 text-xs text-slate-500"
                    x-text="new Date(cal.year,cal.month,cal.picked).toLocaleDateString(undefined,{weekday:'long',year:'numeric',month:'long',day:'numeric'})"></div>

                <div class="mt-3 space-y-3">
                  <template x-if="todayDeadlines().length===0">
                    <div class="text-xs text-slate-500">No deadlines on this day.</div>
                  </template>

                  <template x-for="d in todayDeadlines()" :key="d.id">
                    <div class="rounded-xl border px-3 py-2"
                        :class="d.color">
                      <div class="text-sm font-medium" x-text="d.title"></div>
                      <div class="mt-1 text-xs">
                        <span class="font-semibold" x-text="d.type"></span>
                        <span class="text-slate-500"> ‚Ä¢ </span>
                        <span x-text="d.course"></span>
                        <span class="text-slate-500"> ‚Ä¢ </span>
                        <span x-text="d.time"></span>
                      </div>
                    </div>
                  </template>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- ================= COURSES TAB ================= -->
        <!-- COURSES -->
        <section x-show="page==='courses'" x-cloak>
          <!-- BRANCH: courses-tab -->
          <div class="flex items-center justify-between">
            <div>
              <h1 class="text-3xl font-bold">My Courses</h1>
              <p class="text-slate-600 mt-1">Manage and track your enrolled courses</p>
            </div>
            <div class="px-3 py-1.5 rounded-full bg-sand-200 text-xs text-slate-700">6 Active Courses</div>
          </div>

          <div class="grid lg:grid-cols-3 gap-6 mt-6">
            <template x-for="c in courseCards" :key="c.id">
              <div class="bg-white rounded-xl2 border border-sand-200/70 shadow-card overflow-hidden flex flex-col">
                <div class="h-48 w-full">
                  <img :src="c.image" alt="" class="h-full w-full object-cover">
                </div>
                <div class="p-5 flex-1 flex flex-col">
                  <div class="font-semibold" x-text="c.title"></div>
                  <div class="text-sm text-slate-600" x-text="c.instructor"></div>

                  <div class="mt-3 flex items-center gap-5 text-xs text-slate-600">
                    <div class="flex items-center gap-1">
                      <span class="inline-block w-2 h-2 rounded-full bg-slate-400"></span>
                      <span x-text="c.modules + ' modules'"></span>
                    </div>
                    <div class="flex items-center gap-1">
                      <span class="inline-block w-2 h-2 rounded-full bg-slate-400"></span>
                      <span x-text="c.students"></span>
                    </div>
                  </div>

                  <div class="mt-3 text-xs">
                    <div class="text-slate-500">Next Class</div>
                    <div class="text-slate-700" x-text="c.next"></div>
                  </div>

                  <button
                    class="mt-4 w-full px-4 py-2 rounded-lg bg-rust-500/90 text-white text-sm hover:bg-rust-600"
                    @click="openCourse(c.id)">
                    View Course
                  </button>
                </div>
              </div>
            </template>
          </div>
        </section>

        <!-- COURSE DETAIL -->
        <section x-show="page==='course'" x-cloak>
          <button class="text-sm text-slate-600 hover:underline mb-3" @click="page='courses'">‚Üê Back to Courses</button>

          <h1 class="text-3xl font-bold" x-text="courseDetail.title"></h1>
          <div class="text-slate-600" x-text="courseDetail.code + ' ‚Ä¢ ' + courseDetail.instructorName"></div>

          <div class="grid lg:grid-cols-3 gap-4 mt-5">
            <div class="rounded-xl2 border border-sand-200/70 bg-white shadow-card p-4">
              <div class="text-sm text-slate-500">Schedule</div>
              <div class="font-medium" x-text="courseDetail.schedule"></div>
            </div>
            <div class="rounded-xl2 border border-sand-200/70 bg-white shadow-card p-4">
              <div class="text-sm text-slate-500">Location</div>
              <div class="font-medium" x-text="courseDetail.location"></div>
            </div>
            <div class="rounded-xl2 border border-sand-200/70 bg-white shadow-card p-4">
              <div class="text-sm text-slate-500">Office Hours</div>
              <div class="font-medium" x-text="courseDetail.officeHours"></div>
            </div>
          </div>

          <div class="mt-6 rounded-xl2 border border-sand-200/70 bg-white shadow-card p-4">
            <div class="flex items-center justify-between mb-3">
              <div class="font-semibold">Course Announcements</div>
              <div class="text-xs text-slate-500" x-text="courseDetail.pinned.length + ' Pinned'"></div>
            </div>

            <div class="max-h-[420px] overflow-y-auto pr-1 space-y-3">
              <template x-for="a in courseDetail.announcements" :key="a.id">
                <div class="rounded-lg border border-sand-200 p-4 bg-white">
                  <div class="flex items-start justify-between">
                    <div class="font-medium" x-text="a.title"></div>
                    <span class="text-[10px] px-2 py-0.5 rounded-full border"
                          :class="a.priority==='high' ? 'text-rose-700 border-rose-300 bg-rose-50' : 'text-sand-700 border-sand-300 bg-sand-50' "
                          x-text="a.priority"></span>
                  </div>
                  <div class="text-sm text-slate-700 mt-1" x-text="a.body"></div>
                  <div class="mt-2 text-xs text-slate-500" x-text="a.date + ' ¬∑ ' + a.time"></div>
                </div>
              </template>
            </div>
          </div>

          <div class="mt-4 flex flex-wrap gap-2">
            <template x-for="tab in ['Syllabus','Slides (7)','Materials (6)','Important Dates (10)','Software & Tools (8)','Textbooks (5)']" :key="tab">
              <span class="px-3 py-2 text-sm rounded-full border border-sand-300 bg-white shadow-sm cursor-default" x-text="tab"></span>
            </template>
          </div>
        </section>
        <!-- ================= ASSIGNMENTS TAB ================= -->
        <section x-show="page === 'assignments'">
          <!-- BRANCH: assignments-tab -->
          <div class="p-6 text-center text-slate-500">Assignments page (to be built)</div>
        </section>

        <!-- ================= QUIZZES TAB ================= -->
        <section x-show="page === 'quizzes'">
          <!-- BRANCH: quizzes-tab -->
          <div class="p-6 text-center text-slate-500">Quizzes page (to be built)</div>
        </section>

        <!-- ================= GRADES TAB ================= -->
        <section x-show="page === 'grades'">
          <!-- BRANCH: grades-tab -->
          <div class="p-6 text-center text-slate-500">Grades page (to be built)</div>
        </section>
        <!-- AI ASSISTANT -->
        <section x-show="page==='ai'" x-cloak>
          <!-- BRANCH: ai-assistant-tab -->
          <div class="flex items-center gap-3 mb-6">
            <div class="h-11 w-11 rounded-xl bg-rust-500/90 flex items-center justify-center text-white shadow-card">AI</div>
            <div>
              <h1 class="text-2xl font-bold">AI Teaching Assistant</h1>
              <div class="text-sm text-slate-600">Your personal AI helper for learning, studying, and academic success</div>
            </div>
          </div>

          <div class="rounded-xl2 border border-sand-200/70 bg-white shadow-card mb-5">
            <div class="px-5 py-3 text-sm">
              <span class="font-medium">AI-Powered Learning Support</span>
              <span class="text-slate-600"> ‚Äî Get instant help with questions, lecture summaries, quizzes, and personalized study plans.</span>
            </div>
          </div>

          <div class="flex gap-3 overflow-x-auto pb-2 mb-4">
            <button @click="aiTab='chat'" class="px-4 py-2 rounded-full border text-sm" :class="aiTab==='chat' ? 'bg-sand-100 border-sand-300 font-semibold' : 'bg-white border-sand-200 hover:bg-sand-50'">Chat & FAQs</button>
            <button @click="aiTab='summary'" class="px-4 py-2 rounded-full border text-sm" :class="aiTab==='summary' ? 'bg-sand-100 border-sand-300 font-semibold' : 'bg-white border-sand-200 hover:bg-sand-50'">Summarize</button>
            <button @click="aiTab='quiz'" class="px-4 py-2 rounded-full border text-sm" :class="aiTab==='quiz' ? 'bg-sand-100 border-sand-300 font-semibold' : 'bg-white border-sand-200 hover:bg-sand-50'">Generate Quiz</button>
            <button @click="aiTab='plan'" class="px-4 py-2 rounded-full border text-sm" :class="aiTab==='plan' ? 'bg-sand-100 border-sand-300 font-semibold' : 'bg-white border-sand-200 hover:bg-sand-50'">Course Plan</button>
          </div>

          <!-- Chat -->
          <div x-show="aiTab==='chat'" x-cloak class="grid lg:grid-cols-3 gap-6">
            <div class="lg:col-span-2 rounded-xl2 border border-sand-200/70 bg-white shadow-card p-4">
              <div class="h-[420px] overflow-y-auto space-y-3 pr-1" id="chatScroll">
                <template x-for="m in chat.messages" :key="m.id">
                  <div :class="m.role==='user' ? 'text-right' : 'text-left'">
                    <div class="inline-block rounded-2xl px-4 py-2 text-sm" :class="m.role==='user' ? 'bg-rust-500/90 text-white' : 'bg-sand-100 text-slate-800'">
                      <span x-text="m.text"></span>
                    </div>
                  </div>
                </template>
              </div>
              <div class="mt-4 flex gap-2">
                <input x-model="chat.input" @keydown.enter.prevent="sendChat()" class="flex-1 rounded-lg border border-sand-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-rust-300" placeholder="Ask a question‚Ä¶" />
                <button @click="sendChat()" class="px-4 py-2 rounded-lg bg-rust-500/90 text-white text-sm hover:bg-rust-600">Send</button>
              </div>
            </div>
            <div class="rounded-xl2 border border-sand-200/70 bg-white shadow-card p-4">
              <div class="font-semibold mb-3">Quick FAQs</div>
              <div class="space-y-2 text-sm">
                <template x-for="q in faq" :key="q">
                  <button @click="chat.input=q; sendChat()" class="w-full text-left px-3 py-2 rounded-lg border border-sand-200 hover:bg-sand-50">
                    <span x-text="q"></span>
                  </button>
                </template>
              </div>
              <div class="mt-5 text-xs text-slate-500">Pro tip: include course codes (e.g., ‚ÄúCS 301‚Äù) for better answers.</div>
            </div>
          </div>

          <!-- Summary -->
          <div x-show="aiTab==='summary'" x-cloak class="grid lg:grid-cols-2 gap-6">
            <div class="rounded-xl2 border border-sand-200/70 bg-white shadow-card p-5">
              <div class="font-semibold mb-3">Select Lectures to Summarize</div>
              <div class="grid grid-cols-2 gap-2 text-sm">
                <template x-for="c in courses" :key="c.code">
                  <button class="px-3 py-2 rounded-lg border" :class="selectedCourse===c.code ? 'border-rust-500 bg-sand-100 font-semibold' : 'border-sand-300 hover:bg-sand-50'" @click="selectedCourse=c.code; selectedLectures=[]">
                    <span x-text="c.code"></span>
                  </button>
                </template>
              </div>

              <div class="mt-4">
                <div class="text-xs uppercase tracking-wide text-slate-500 mb-2">Lectures</div>
                <template x-if="currentLectures().length===0">
                  <div class="text-sm text-slate-500">Pick a course to see its lectures.</div>
                </template>
                <div class="space-y-2">
                  <template x-for="l in currentLectures()" :key="l.id">
                    <label class="flex items-center gap-2 text-sm px-3 py-2 rounded-lg border cursor-pointer" :class="selectedLectures.includes(l.id)?'border-rust-500 bg-sand-100':'border-sand-300 hover:bg-sand-50'">
                      <input type="checkbox" class="accent-rust-500" :value="l.id" @change="toggleLecture(l.id)" :checked="selectedLectures.includes(l.id)">
                      <span x-text="l.title"></span>
                    </label>
                  </template>
                </div>
              </div>

              <button @click="generateSummary()" class="mt-4 w-full px-4 py-2 rounded-lg bg-rust-500/90 text-white text-sm hover:bg-rust-600 disabled:opacity-50" :disabled="selectedLectures.length===0">Generate Summary</button>
            </div>

            <div class="rounded-xl2 border border-sand-200/70 bg-white shadow-card p-5">
              <div class="font-semibold mb-3">Generated Summary</div>
              <template x-if="!summary.html"><div class="text-slate-500 text-sm">Select a course and lectures, then click ‚ÄúGenerate Summary‚Äù.</div></template>
              <div class="prose prose-sm max-w-none" x-html="summary.html"></div>
            </div>
          </div>

          <!-- Quiz -->
          <div x-show="aiTab==='quiz'" x-cloak class="grid lg:grid-cols-2 gap-6">
            <div class="rounded-xl2 border border-sand-200/70 bg-white shadow-card p-5">
              <div class="font-semibold mb-3">Configure Quiz Generation</div>
              <div class="grid grid-cols-2 gap-2 text-sm">
                <template x-for="c in courses" :key="c.code">
                  <button class="px-3 py-2 rounded-lg border" :class="quiz.course===c.code ? 'border-rust-500 bg-sand-100 font-semibold' : 'border-sand-300 hover:bg-sand-50'" @click="quiz.course=c.code; quiz.lectures=[]">
                    <span x-text="c.code"></span>
                  </button>
                </template>
              </div>

              <div class="mt-4">
                <div class="text-xs uppercase tracking-wide text-slate-500 mb-2">Lectures</div>
                <div class="space-y-2">
                  <template x-for="l in lecturesByCode(quiz.course)" :key="l.id">
                    <label class="flex items-center gap-2 text-sm px-3 py-2 rounded-lg border cursor-pointer" :class="quiz.lectures.includes(l.id)?'border-rust-500 bg-sand-100':'border-sand-300 hover:bg-sand-50'">
                      <input type="checkbox" class="accent-rust-500" :value="l.id" @change="toggleQuizLecture(l.id)" :checked="quiz.lectures.includes(l.id)">
                      <span x-text="l.title"></span>
                    </label>
                  </template>
                </div>
              </div>

              <button @click="generateQuiz()" class="mt-4 w-full px-4 py-2 rounded-lg bg-rust-500/90 text-white text-sm hover:bg-rust-600 disabled:opacity-50" :disabled="quiz.lectures.length===0">Generate Quiz</button>
            </div>

            <div class="rounded-xl2 border border-sand-200/70 bg-white shadow-card p-5">
              <div class="font-semibold mb-3">Generated Quiz</div>
              <template x-if="quizOut.length===0">
                <div class="text-slate-500 text-sm">Select a course and lectures, then click ‚ÄúGenerate Quiz‚Äù.</div>
              </template>
              <div class="space-y-4">
                <template x-for="(q,idx) in quizOut" :key="idx">
                  <div class="rounded-lg border border-sand-200 p-4">
                    <div class="text-sm font-medium mb-2" x-text="'Q' + (idx+1) + '. ' + q.q"></div>
                    <div class="space-y-1 text-sm">
                      <template x-for="(opt,i) in q.options" :key="i">
                        <label class="flex items-center gap-2">
                          <input type="radio" :name="'q'+idx" class="accent-rust-500">
                          <span x-text="opt"></span>
                        </label>
                      </template>
                    </div>
                    <details class="mt-2 text-xs">
                      <summary class="cursor-pointer text-slate-600">Show answer</summary>
                      <div class="mt-1"><span class="font-medium">Answer:</span> <span x-text="q.answer"></span></div>
                    </details>
                  </div>
                </template>
              </div>
            </div>
          </div>

          <!-- Course Plan -->
          <div x-show="aiTab==='plan'" x-cloak class="grid lg:grid-cols-2 gap-6">
            <div class="rounded-xl2 border border-sand-200/70 bg-white shadow-card p-5">
              <div class="font-semibold mb-3">Create Personalized Study Plan</div>

              <label class="block text-sm mb-1 text-slate-700">Your Learning Goals</label>
              <textarea x-model="plan.goals" class="w-full rounded-lg border border-sand-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-rust-300" rows="4" placeholder="E.g., Master data structures, improve web development skills, prepare for midterms..."></textarea>

              <label class="block text-sm mt-4 mb-1 text-slate-700">Study Pace & Preferences</label>
              <textarea x-model="plan.pace" class="w-full rounded-lg border border-sand-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-rust-300" rows="3" placeholder="E.g., I have 15 hours per week, prefer morning study sessions, need to focus more on CS courses..."></textarea>

              <div class="mt-4 text-xs rounded-lg border border-sand-200 p-3 bg-sand-50">
                <div class="font-medium mb-1">Performance-Based Recommendations</div>
                Your study plan will be optimized based on your current grades and course progress.
              </div>

              <button @click="generatePlan()" class="mt-4 w-full px-4 py-2 rounded-lg bg-rust-500/90 text-white text-sm hover:bg-rust-600">Generate Study Plan</button>
            </div>

            <div class="rounded-xl2 border border-sand-200/70 bg-white shadow-card p-5">
              <div class="font-semibold mb-3">Your Personalized Plan</div>
              <template x-if="planOut.length===0">
                <div class="text-slate-500 text-sm">Enter your learning goals and study preferences to generate a personalized plan tailored to your needs.</div>
              </template>
              <div class="space-y-3">
                <template x-for="(p, i) in planOut" :key="i">
                  <div class="rounded-lg border border-sand-200 p-3">
                    <div class="font-medium text-sm" x-text="p.title"></div>
                    <ul class="mt-1 text-sm list-disc list-inside text-slate-700">
                      <template x-for="step in p.steps" :key="step">
                        <li x-text="step"></li>
                      </template>
                    </ul>
                  </div>
                </template>
              </div>
            </div>
          </div>
        </section>

        <!-- PROFILE -->
        <section x-show="page==='profile'" x-cloak>
            <!-- BRANCH: profile-settings -->
            <div x-data="profilePage()" x-init="init()" class="space-y-6">

              <!-- Header -->
              <div class="flex items-center justify-between">
                <div>
                  <h1 class="text-3xl font-extrabold text-slate-900">My Profile</h1>
                  <p class="text-slate-500">Manage your personal information and account settings</p>
                </div>

                <!-- Edit / Save / Cancel -->
                <div class="flex gap-3">
                  <template x-if="!isEditing">
                    <button @click="startEdit()"
                            class="inline-flex items-center gap-2 rounded-lg bg-amber-600 px-4 py-2 text-white hover:bg-amber-700">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor"><path d="M21.731 2.269a2.625 2.625 0 0 0-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 0 0 0-3.712z"/><path d="M3 17.25V21h3.75L19.81 7.94l-3.712-3.712L3 17.25z"/></svg>
                      Edit Profile
                    </button>
                  </template>

                  <template x-if="isEditing">
                    <div class="flex gap-3">
                      <button @click="save()"
                              class="inline-flex items-center gap-2 rounded-lg bg-amber-600 px-4 py-2 text-white hover:bg-amber-700">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
                        Save Changes
                      </button>
                      <button @click="cancel()"
                              class="inline-flex items-center gap-2 rounded-lg bg-white px-4 py-2 text-slate-700 ring-1 ring-slate-300 hover:bg-slate-50">
                        Cancel
                      </button>
                    </div>
                  </template>
                </div>
              </div>

              <!-- Top summary card -->
              <div class="rounded-2xl border border-slate-200 bg-white p-6">
                <div class="grid grid-cols-1 gap-6 md:grid-cols-3">
                  <!-- Left: avatar + name -->
                  <div class="col-span-1 flex items-center gap-5">
                    <div class="grid h-24 w-24 place-items-center rounded-full bg-amber-700 text-2xl font-bold text-white">
                      <span x-text="initials(profile.firstName, profile.lastName)"></span>
                    </div>
                    <div>
                      <h2 class="text-xl font-semibold text-slate-900" x-text="fullName"></h2>
                      <div class="text-slate-500" x-text="profile.major || 'Major'"></div>
                      <span class="mt-1 inline-block rounded-full bg-amber-100 px-2.5 py-0.5 text-xs font-medium text-amber-800"
                            x-text="profile.year || 'Year'"></span>
                    </div>
                  </div>

                  <!-- Middle: About Me -->
                  <div class="col-span-2">
                    <label class="mb-1 block text-sm font-medium text-slate-700">About Me</label>
                    <template x-if="!isEditing">
                      <p class="rounded-lg border border-slate-200 bg-slate-50 p-3 text-slate-700"
                        x-text="profile.about || 'Tell us about yourself‚Ä¶'"></p>
                    </template>
                    <template x-if="isEditing">
                      <textarea x-model="draft.about" rows="3"
                                class="w-full rounded-lg border-slate-300 focus:border-amber-500 focus:ring-amber-500"></textarea>
                    </template>
                  </div>
                </div>

                <!-- KPIs -->
                <div class="mt-6 grid grid-cols-1 gap-4 md:grid-cols-3">
                  <div class="rounded-xl border border-slate-200 bg-slate-50 p-4">
                    <div class="text-xs uppercase tracking-wide text-slate-500">GPA</div>
                    <div class="text-2xl font-semibold text-slate-900" x-text="profile.gpa || '‚Äî'"></div>
                  </div>
                  <div class="rounded-xl border border-slate-200 bg-slate-50 p-4">
                    <div class="text-xs uppercase tracking-wide text-slate-500">Student ID</div>
                    <div class="text-2xl font-semibold text-slate-900" x-text="profile.studentId || '‚Äî'"></div>
                  </div>
                  <div class="rounded-xl border border-slate-200 bg-slate-50 p-4">
                    <div class="text-xs uppercase tracking-wide text-slate-500">Enrolled</div>
                    <div class="text-2xl font-semibold text-slate-900" x-text="profile.enrolledTerm || '‚Äî'"></div>
                  </div>
                </div>
              </div>

              <!-- Two-column details -->
              <div class="grid grid-cols-1 gap-6 lg:grid-cols-2">
                <!-- Personal Information -->
                <div class="space-y-4 rounded-2xl border border-slate-200 bg-white p-6">
                  <div class="mb-1 flex items-center gap-2"><span class="text-amber-600">üë§</span><h3 class="text-lg font-semibold text-slate-900">Personal Information</h3></div>
                  <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
                    <div>
                      <label class="mb-1 block text-sm text-slate-600">First Name</label>
                      <template x-if="!isEditing"><p class="rounded-lg border border-slate-200 bg-slate-50 p-2.5" x-text="profile.firstName"></p></template>
                      <template x-if="isEditing"><input x-model="draft.firstName" class="w-full rounded-lg border-slate-300 focus:border-amber-500 focus:ring-amber-500"/></template>
                    </div>
                    <div>
                      <label class="mb-1 block text-sm text-slate-600">Last Name</label>
                      <template x-if="!isEditing"><p class="rounded-lg border border-slate-200 bg-slate-50 p-2.5" x-text="profile.lastName"></p></template>
                      <template x-if="isEditing"><input x-model="draft.lastName" class="w-full rounded-lg border-slate-300 focus:border-amber-500 focus:ring-amber-500"/></template>
                    </div>

                    <div class="md:col-span-2">
                      <label class="mb-1 block text-sm text-slate-600">Email Address</label>
                      <input x-model="draft.email" disabled class="w-full rounded-lg border-slate-200 bg-slate-50 text-slate-500"/>
                      <p class="mt-1 text-xs text-slate-500">Email is fixed to the account you registered with.</p>
                    </div>

                    <div class="md:col-span-2">
                      <label class="mb-1 block text-sm text-slate-600">Phone Number</label>
                      <template x-if="!isEditing"><p class="rounded-lg border border-slate-200 bg-slate-50 p-2.5" x-text="profile.phone || '‚Äî'"></p></template>
                      <template x-if="isEditing"><input x-model="draft.phone" class="w-full rounded-lg border-slate-300 focus:border-amber-500 focus:ring-amber-500"/></template>
                    </div>
                  </div>
                </div>

                <!-- Academic Information -->
                <div class="space-y-4 rounded-2xl border border-slate-200 bg-white p-6">
                  <div class="mb-1 flex items-center gap-2"><span class="text-amber-600">üéì</span><h3 class="text-lg font-semibold text-slate-900">Academic Information</h3></div>
                  <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
                    <div>
                      <label class="mb-1 block text-sm text-slate-600">Student ID</label>
                      <input x-model="draft.studentId" disabled class="w-full rounded-lg border-slate-200 bg-slate-50 text-slate-500"/>
                    </div>
                    <div>
                      <label class="mb-1 block text-sm text-slate-600">Year</label>
                      <template x-if="!isEditing"><p class="rounded-lg border border-slate-200 bg-slate-50 p-2.5" x-text="profile.year || '‚Äî'"></p></template>
                      <template x-if="isEditing">
                        <select x-model="draft.year" class="w-full rounded-lg border-slate-300 focus:border-amber-500 focus:ring-amber-500">
                          <option>Freshman</option><option>Sophomore</option><option>Junior</option><option>Senior</option><option>Graduate</option>
                        </select>
                      </template>
                    </div>
                    <div>
                      <label class="mb-1 block text-sm text-slate-600">Major</label>
                      <template x-if="!isEditing"><p class="rounded-lg border border-slate-200 bg-slate-50 p-2.5" x-text="profile.major || '‚Äî'"></p></template>
                      <template x-if="isEditing"><input x-model="draft.major" class="w-full rounded-lg border-slate-300 focus:border-amber-500 focus:ring-amber-500"/></template>
                    </div>
                    <div>
                      <label class="mb-1 block text-sm text-slate-600">Minor</label>
                      <template x-if="!isEditing"><p class="rounded-lg border border-slate-200 bg-slate-50 p-2.5" x-text="profile.minor || '‚Äî'"></p></template>
                      <template x-if="isEditing"><input x-model="draft.minor" class="w-full rounded-lg border-slate-300 focus:border-amber-500 focus:ring-amber-500"/></template>
                    </div>
                    <div class="md:col-span-2">
                      <label class="mb-1 block text-sm text-slate-600">Expected Graduation</label>
                      <template x-if="!isEditing"><p class="rounded-lg border border-slate-200 bg-slate-50 p-2.5" x-text="profile.expectedGrad || '‚Äî'"></p></template>
                      <template x-if="isEditing"><input x-model="draft.expectedGrad" placeholder="e.g., Spring 2026" class="w-full rounded-lg border-slate-300 focus:border-amber-500 focus:ring-amber-500"/></template>
                    </div>
                  </div>
                </div>

                <!-- Address Information -->
                <div class="space-y-4 rounded-2xl border border-slate-200 bg-white p-6">
                  <div class="mb-1 flex items-center gap-2"><span class="text-amber-600">üìç</span><h3 class="text-lg font-semibold text-slate-900">Address Information</h3></div>
                  <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
                    <div class="md:col-span-2">
                      <label class="mb-1 block text-sm text-slate-600">Street Address</label>
                      <template x-if="!isEditing"><p class="rounded-lg border border-slate-200 bg-slate-50 p-2.5" x-text="profile.street || '‚Äî'"></p></template>
                      <template x-if="isEditing"><input x-model="draft.street" class="w-full rounded-lg border-slate-300 focus:border-amber-500 focus:ring-amber-500"/></template>
                    </div>
                    <div>
                      <label class="mb-1 block text-sm text-slate-600">City</label>
                      <template x-if="!isEditing"><p class="rounded-lg border border-slate-200 bg-slate-50 p-2.5" x-text="profile.city || '‚Äî'"></p></template>
                      <template x-if="isEditing"><input x-model="draft.city" class="w-full rounded-lg border-slate-300 focus:border-amber-500 focus:ring-amber-500"/></template>
                    </div>
                    <div>
                      <label class="mb-1 block text-sm text-slate-600">State</label>
                      <template x-if="!isEditing"><p class="rounded-lg border border-slate-200 bg-slate-50 p-2.5" x-text="profile.state || '‚Äî'"></p></template>
                      <template x-if="isEditing"><input x-model="draft.state" class="w-full rounded-lg border-slate-300 focus:border-amber-500 focus:ring-amber-500"/></template>
                    </div>
                    <div>
                      <label class="mb-1 block text-sm text-slate-600">ZIP Code</label>
                      <template x-if="!isEditing"><p class="rounded-lg border border-slate-200 bg-slate-50 p-2.5" x-text="profile.zip || '‚Äî'"></p></template>
                      <template x-if="isEditing"><input x-model="draft.zip" class="w-full rounded-lg border-slate-300 focus:border-amber-500 focus:ring-amber-500"/></template>
                    </div>
                    <div>
                      <label class="mb-1 block text-sm text-slate-600">Country</label>
                      <template x-if="!isEditing"><p class="rounded-lg border border-slate-200 bg-slate-50 p-2.5" x-text="profile.country || '‚Äî'"></p></template>
                      <template x-if="isEditing"><input x-model="draft.country" class="w-full rounded-lg border-slate-300 focus:border-amber-500 focus:ring-amber-500"/></template>
                    </div>
                  </div>
                </div>

                <!-- Account Settings -->
                <div class="space-y-4 rounded-2xl border border-slate-200 bg-white p-6">
                  <div class="mb-1 flex items-center gap-2"><span class="text-amber-600">üõ°Ô∏è</span><h3 class="text-lg font-semibold text-slate-900">Account Settings</h3></div>

                  <div class="rounded-xl border border-slate-200 bg-slate-50 p-4">
                    <div class="flex items-center justify-between">
                      <div>
                        <div class="text-sm text-slate-600">Email Verified</div>
                        <div class="text-slate-800">Your email has been verified</div>
                      </div>
                      <div class="grid h-7 w-7 place-items-center rounded-full bg-amber-100 text-amber-700">‚úî</div>
                    </div>
                  </div>

                  <div class="rounded-xl border border-slate-200 bg-slate-50 p-4">
                    <div class="flex items-center justify-between">
                      <div>
                        <div class="text-sm text-slate-600">Account Status</div>
                        <div class="text-slate-800">Active ¬∑ Good Standing</div>
                      </div>
                      <span class="rounded-full bg-emerald-100 px-3 py-1 text-xs font-medium text-emerald-700">Active</span>
                    </div>
                  </div>

                  <div class="space-y-3">
                    <button class="w-full rounded-lg bg-white px-4 py-2 text-left text-slate-700 ring-1 ring-slate-300 hover:bg-slate-50">Change Password</button>
                    <button class="w-full rounded-lg bg-white px-4 py-2 text-left text-slate-700 ring-1 ring-slate-300 hover:bg-slate-50">Update Email Preferences</button>
                    <button class="w-full rounded-lg bg-white px-4 py-2 text-left text-slate-700 ring-1 ring-slate-300 hover:bg-slate-50">Privacy Settings</button>
                  </div>
                </div>
              </div>
            </div>

        </section>

        <!-- SETTINGS -->
        <section x-show="page==='settings'" x-cloak>
          <!-- BRANCH: settings -->
          <h1 class="text-2xl font-bold mb-4">Settings</h1>
          <div class="rounded-xl2 border border-sand-200/70 bg-white shadow-card p-5 max-w-xl">
            <div class="text-sm text-slate-600">Additional preferences can go here.</div>
          </div>
        </section>
      </div>
    </main>
  </div>

  <script>
    /* ===========================================================
   IGNITE LMS ‚Äî DATA MODEL REFERENCE (Student LMS only for now)
   -----------------------------------------------------------
   This does NOT change visuals. It just explains data shapes.
   ===========================================================

   STORAGE KEYS (auto-scoped per role):
   ignite_student_profile
   ignite_student_courses
   ignite_student_assignments
   ignite_student_submissions
   ignite_student_grades
   ignite_student_quizzes
   ignite_student_ai_summaries

   Shared arrays in app():
   - news[] ‚Üí dashboard-tab
   - courseCards[] ‚Üí courses-tab
   - courseDetail{} ‚Üí courses-tab (detail view)
   - assignments[] ‚Üí assignments-tab
   - grades[] ‚Üí grades-tab
   - aiSummaries{} ‚Üí ai-assistant-tab
   - profile{} ‚Üí profile-settings

   Shared helper methods:
   - listMaterials(courseCode)
   - addMaterial(courseCode, object)
   - listAssignments(courseCode)
   - submitAssignment(assignmentId, fileObj)
   - generateSummaryFromMaterials(courseCode)
   =========================================================== */

    function app(){
      return {
        /* ===== Role & feature gates (Student-only today) ===== */
        userRole: localStorage.getItem('ignite_role') || 'student',      // 'student' | 'professor'
        get isStudent(){ return this.userRole === 'student'; },
        get isProfessor(){ return this.userRole === 'professor'; },
        setRole(role){                                                    // keep for later when you add a login/role switch
          this.userRole = role;
          localStorage.setItem('ignite_role', role);
          // If you eventually diverge routes per role, you could reset page here.
          // this.page = this.isStudent ? 'dashboard' : 'prof-dashboard';
        },
        features: {                                                       // flip to true as you add professor pages later
          professorLMS: false
        },
        getStoreKey(key){                                                 // keep student/professor data isolated
          return `ignite_${this.userRole}_${key}`;
        },

        /* ===== UI state (unchanged visual behavior) ===== */
        sidebarOpen: false,
        page: 'dashboard',

        /* ===== Profile (role-scoped storage) ===== */
        profile: JSON.parse(localStorage.getItem(`ignite_${(localStorage.getItem('ignite_role')||'student')}_profile`)
                  || '{"firstName":"Sarah","email":"sarahj@university.edu"}'),
        saveProfile(){
          localStorage.setItem(this.getStoreKey('profile'), JSON.stringify(this.profile));
        },

        /* ===== Dashboard content (student sample data) ===== */
        news: [
          {id:1, title:'New Computer Science Lab Opens on Campus', tag:'Campus', date:'Oct 20, 2025', img:'https://images.unsplash.com/photo-1518779578993-ec3579fee39f?q=80&w=800&auto=format&fit=crop', snippet:'State-of-the-art facility features cutting-edge technology and collaborative workspaces for students.'},
          {id:2, title:'Spring 2026 Registration Now Open', tag:'Academic', date:'Oct 18, 2025', img:'https://images.unsplash.com/photo-1523580494863-6f3031224c94?q=80&w=800&auto=format&fit=crop', snippet:'Students can now register for spring semester courses. Priority registration ends November 1st.'},
          {id:3, title:'Career Fair Success: 500+ Students Connected with Employers', tag:'Career', date:'Oct 15, 2025', img:'https://images.unsplash.com/photo-1522075469751-3a6694fb2f61?q=80&w=800&auto=format&fit=crop', snippet:'Annual fall career fair brings together top companies and talented students for networking opportunities.'}
        ],
        important: [
          {id:1,title:'Data Structures Quiz',when:'Nov 10 ‚Ä¢ 10:30 AM'},
          {id:2,title:'Linear Algebra Midterm',when:'Nov 15 ‚Ä¢ 1:00 PM'},
          {id:3,title:'Project Teams Due',when:'Nov 20 ‚Ä¢ 11:59 PM'}
        ],

        /* ===== Mini calendar (unchanged) ===== */
        cal: (()=>{const d=new Date();return {y:d.getFullYear(), m:d.getMonth()};})(),
        get daysMatrix(){
          const {y,m}=this.cal;
          const first=new Date(y,m,1);
          const startIdx=first.getDay();
          const daysInMonth=new Date(y,m+1,0).getDate();
          const prevDays=new Date(y,m,0).getDate();
          const cells=[];
          for(let i=startIdx-1;i>=0;i--){ cells.push({day:prevDays-i,inMonth:false,date:new Date(y,m-1,prevDays-i)}); }
          for(let d=1; d<=daysInMonth; d++){ cells.push({day:d,inMonth:true,date:new Date(y,m,d)}); }
          while(cells.length%7!==0){
            const d = cells.length - (startIdx + daysInMonth) + 1;
            cells.push({day:d,inMonth:false,date:new Date(y,m+1,d)});
          }
          return cells;
        },
        monthLabel(){ return new Date(this.cal.y,this.cal.m,1).toLocaleString('en',{month:'long',year:'numeric'}); },
        prevMonth(){ if(this.cal.m===0){this.cal.m=11;this.cal.y--;} else {this.cal.m--;} },
        nextMonth(){ if(this.cal.m===11){this.cal.m=0;this.cal.y++;} else {this.cal.m++;} },
        isToday(d){
          const t=new Date();
          return d.inMonth && d.date.getFullYear()===t.getFullYear() && d.date.getMonth()===t.getMonth() && d.date.getDate()===t.getDate();
        },

        /* ===== Courses (student view data) ===== */
        courseCards: [
          {id:1,title:'Advanced Web Development',instructor:'Dr. Emily Chen',modules:12,students:'45',next:'Oct 21, 10:00 AM',image:'https://images.unsplash.com/photo-1518770660439-4636190af475?q=80&w=1600&auto=format&fit=crop'},
          {id:2,title:'Data Structures & Algorithms',instructor:'Prof. Michael Zhang',modules:15,students:'60',next:'Oct 22, 2:00 PM',image:'https://images.unsplash.com/photo-1515879218367-8466d910aaa4?q=80&w=1600&auto=format&fit=crop'},
          {id:3,title:'Linear Algebra',instructor:'Dr. Sarah Johnson',modules:10,students:'38',next:'Oct 23, 11:00 AM',image:'https://images.unsplash.com/photo-1523246191918-0c2f021d2b9a?q=80&w=1600&auto=format&fit=crop'}
        ],
        courseDetail: {
          id:1, code:'CS 301', title:'Advanced Web Development', instructorName:'Dr. Emily Chen',
          schedule:'Monday & Wednesday, 10:00 AM - 11:30 AM',
          location:'Room 301, CS Building',
          officeHours:'Tuesday & Thursday, 2:00 PM - 4:00 PM',
          pinned:[1,2,3],
          announcements:[
            {id:1, title:'Welcome to Advanced Web Development!', body:'Welcome everyone! Please review the syllabus and set up your dev environment before our first class.', priority:'high', date:'Sept 1, 2025', time:'9:00 AM'},
            {id:2, title:'Project Teams Formation Deadline', body:'Reminder: Team formation is due by Sept 20th. Use the discussion board to find teammates (3-4 members).', priority:'high', date:'Sept 15, 2025', time:'2:30 PM'},
            {id:3, title:'Office Hours Update', body:'Office hours moved to Wednesday 3‚Äì5 PM due to a faculty meeting. Apologies for any inconvenience.', priority:'medium', date:'Oct 1, 2025', time:'11:15 AM'}
          ]
        },
        openCourse(id){ this.page='course'; },

        /* ===== AI Assistant (student) ===== */
        aiTab: 'chat',
        faq: [
          'How do I submit assignments?','When are grades posted?','How can I contact my instructor?',
          'What‚Äôs the late submission policy?','How do I access lecture recordings?'
        ],
        chat: {
          input:'',
          messages:[
            {id:1, role:'assistant', text:"Hello! I'm your AI Teaching Assistant. I'm here to help you with questions, summarize lectures, generate quizzes, and create personalized study plans. How can I assist you today?"}
          ]
        },
        sendChat(){
          const text=this.chat.input.trim();
          if(!text) return;
          this.chat.messages.push({id:Date.now(), role:'user', text});
          this.chat.messages.push({id:Date.now()+1, role:'assistant', text:'Got it! Here‚Äôs a quick tip: include your course code (e.g., ‚ÄúCS 301‚Äù) for a more targeted answer.'});
          this.chat.input='';
          this.$nextTick(()=>{ const el=document.getElementById('chatScroll'); el && (el.scrollTop=el.scrollHeight); });
        },

        /* ===== Course + Lectures used by Summary/Quiz (student) ===== */
        courses: [
          {code:'CS 401', lectures:[
            {id:'cs401-1', title:'Introduction to React'},
            {id:'cs401-2', title:'State Management with Hooks'},
            {id:'cs401-3', title:'Component Lifecycle'},
            {id:'cs401-4', title:'Advanced Patterns'},
            {id:'cs401-5', title:'Performance Optimization'},
          ]},
          {code:'CS 301', lectures:[
            {id:'cs301-1', title:'HTTP & REST'},
            {id:'cs301-2', title:'Frontend Architecture'},
            {id:'cs301-3', title:'Routing & SPA'},
          ]},
          {code:'CS 350', lectures:[
            {id:'cs350-1', title:'Algorithm Analysis'},
            {id:'cs350-2', title:'Sorting & Searching'},
            {id:'cs350-3', title:'Trees & Graphs'},
          ]},
          {code:'ENG 202', lectures:[{id:'eng202-1', title:'Rhetorical Strategies'},{id:'eng202-2', title:'Synthesis & Argument'}]},
          {code:'MATH 201', lectures:[{id:'math201-1', title:'Limits & Continuity'},{id:'math201-2', title:'Derivatives'}]},
          {code:'PHYS 201', lectures:[{id:'phys201-1', title:'Kinematics'},{id:'phys201-2', title:'Dynamics'}]},
        ],
        selectedCourse:'CS 401',
        selectedLectures:[],
        currentLectures(){
          const c=this.courses.find(x=>x.code===this.selectedCourse);
          return c? c.lectures : [];
        },
        toggleLecture(id){
          const i=this.selectedLectures.indexOf(id);
          if(i>=0) this.selectedLectures.splice(i,1);
          else this.selectedLectures.push(id);
        },
        summary:{html:''},
        generateSummary(){
          const titles=this.currentLectures().filter(l=>this.selectedLectures.includes(l.id)).map(l=>l.title);
          this.summary.html = `
            <h4>Summary for ${this.selectedCourse}</h4>
            <ul>${titles.map(t=>`<li><strong>${t}:</strong> key concepts, practical examples, and typical pitfalls.</li>`).join('')}</ul>
            <p><em>Main takeaways:</em> build foundations, practice frequently, and connect concepts across lectures.</p>
          `;
        },

        /* ===== Quiz ===== */
        quiz:{course:'CS 401', lectures:[]},
        lecturesByCode(code){
          const c=this.courses.find(x=>x.code===code);
          return c? c.lectures : [];
        },
        toggleQuizLecture(id){
          const i=this.quiz.lectures.indexOf(id);
          if(i>=0) this.quiz.lectures.splice(i,1);
          else this.quiz.lectures.push(id);
        },
        quizOut:[],
        generateQuiz(){
          this.quizOut = this.quiz.lectures.map((lid,idx)=>({
            q:`What is a key concept from ‚Äú${(this.lecturesByCode(this.quiz.course).find(l=>l.id===lid)||{}).title || 'Selected Lecture'}‚Äù?`,
            options:['Basic principles','Advanced techniques','Practical applications','All of the above'],
            answer:'All of the above'
          }));
        },

        /* ===== Study Plan ===== */
        plan:{goals:'', pace:''},
        planOut:[],
        generatePlan(){
          const g=this.plan.goals || 'Improve overall performance across courses';
          const p=this.plan.pace || '10‚Äì12 hrs/week';
          this.planOut = [
            {title:'Weekly Structure', steps:[
              'Mon/Wed/Fri: 60‚Äì90 min focused problem-solving',
              'Tue/Thu: Review notes + summarize key ideas',
              'Weekend: 2‚Äì3 hrs project or past papers'
            ]},
            {title:'Focus Areas', steps:[
              `Goals: ${g}`,
              'Prioritize weak topics from latest quizzes/assignments',
              'Schedule checkpoints every Sunday evening'
            ]},
            {title:'Time Allocation', steps:[
              `Planned study time: ${p}`,
              'Split time evenly across active courses unless deadlines require rebalancing'
            ]}
          ];
        }

        /* ===============================
          Professor LMS (future)
          - When ready, create professor-only pages/components.
          - Gate them with:  x-show="isProfessor && features.professorLMS"
          - Store data with this.getStoreKey('something')
          - Keep student UI untouched.
          =============================== */
      }
    }
    function profilePage() {
      return {
        isEditing: false,
        profile: {
          firstName: 'Sarah',
          lastName: 'Johnson',
          email: 'sarah.j@university.edu',
          phone: '(555) 123-4567',
          about: 'Computer Science student passionate about web development and AI. Love building innovative solutions and learning new technologies.',
          gpa: '3.85',
          studentId: 'STU-2024-001234',
          enrolledTerm: 'Fall 2022',
          major: 'Computer Science',
          minor: 'Mathematics',
          year: 'Junior',
          expectedGrad: 'Spring 2025',
          street: '123 University Ave, Apt 4B',
          city: 'Boston',
          state: 'MA',
          zip: '02115',
          country: 'United States'
        },
        draft: {},

        get fullName() { return `${this.profile.firstName} ${this.profile.lastName}`.trim(); },

        init() {
          const saved = localStorage.getItem('ignite_profile_v1');
          if (saved) {
            try { this.profile = JSON.parse(saved); } catch(e) {}
          }
          this.draft = structuredClone(this.profile);
        },

        persist() {
          localStorage.setItem('ignite_profile_v1', JSON.stringify(this.profile));
        },

        startEdit() {
          this.draft = structuredClone(this.profile);
          this.isEditing = true;
        },

        save() {
          if (!this.draft.firstName || !this.draft.lastName) {
            alert('Please enter your first and last name.');
            return;
          }
          // lock email & studentId
          this.draft.email = this.profile.email;
          this.draft.studentId = this.profile.studentId;

          this.profile = structuredClone(this.draft);
          this.persist();
          this.isEditing = false;
        },

        cancel() {
          this.draft = structuredClone(this.profile);
          this.isEditing = false;
        },

        initials(fn, ln) {
          const a = (fn || '').trim()[0] || '';
          const b = (ln || '').trim()[0] || '';
          return (a + b || 'SJ').toUpperCase();
        }
      }
    }

  </script>
</body>
</html>
